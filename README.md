# Unreal MCP ‚Äî Remote control for Unreal Editor via MCP (UE 5.6)

> Contr√¥lez l‚Äô√âditeur Unreal depuis un serveur MCP (Python) et des agents externes.
> Version compatible **UE 5.6**. R√©seau fiabilis√© avec **Protocol v1** (framed JSON + handshake + ping/pong).

## ‚ú® Fonctionnalit√©s actuelles
- **Protocol v1** : framing binaire (uint32 + JSON), handshake versionn√©, heartbeats, sch√©ma d‚Äôerreurs.
- **S√©curit√©** : gates **AllowWrite / DryRun / AllowedContentRoots / Tool allow/deny-list** + audit JSON.
- **Transactions & Undo** : toutes les mutations sont encapsul√©es dans des transactions √©diteur.
- **Source Control int√©gr√©** : `sc.status / sc.checkout / sc.add / sc.revert / sc.submit` (provider-agnostic).
- **Assets v1 (lecture)** : `asset.find / asset.exists / asset.metadata` via Asset Registry.
- **Assets v2 (CRUD)** : `asset.create_folder / asset.rename / asset.delete / asset.fix_redirectors / asset.save_all`.
- **Assets v3 (Batch Import)** : `asset.batch_import` pour importer FBX/Textures/Audio avec presets, options et SCM.
- **Sequencer v1** : `sequence.create` pour g√©n√©rer un Level Sequence (fps, dur√©e, √©valuation, cam√©ra/camera-cut/bind optionnels).
- **Materials v1 (Material Instances)** : `mi.create` et `mi.set_params` pour cr√©er des MI et r√©gler leurs overrides.
- **Niagara v1 (Editor)** : `niagara.spawn_component / niagara.set_user_params / niagara.activate / niagara.deactivate`.
- **Actors v1 (Editor)** : `actor.spawn / actor.destroy / actor.attach / actor.transform / actor.tag` (transactions, s√©lection, audit).
- **Camera helpers (Editor)** : `level.select / viewport.focus / camera.bookmark` (navigation + bookmarks, session & persistance).
- **Build & Test v2** : wrappers RunUAT `BuildCookRun`, `automation.run_specs` (Editor-Cmd) et `gauntlet.run` (cooked) avec logs persistants & parsing basique.
- **Settings Plugin** : Project Settings ‚Üí **Plugins ‚Üí Unreal MCP** (Network, Security, SCM, Logging, Diagnostics).

## üõ°Ô∏è Networking Reliability (Protocol v1.1)
- **Handshake v1.1** : reprise de session (`resumeToken`) et exposition de la fen√™tre de backpressure (`windowMax`).
- **Idempotence** : chaque requ√™te transporte d√©sormais un `idempotencyKey` (d√©riv√© du `requestId`).
- **Dedup JSONL** : le serveur Python conserve les r√©ponses pendant 10 min (`logs/dedup.jsonl`) pour rejouer exactement une fois.
- **Logs DX** : √©v√©nements structur√©s `connection.resume` et `dedup.hit` pour suivre les reconnections et d√©duplications.

## üîß Installation rapide

1. **Cloner** ce repo (ou votre fork) et ouvrir le projet UE.
2. **Activer le plugin** *Unreal MCP* dans l‚Äô√©diteur si n√©cessaire.
3. **V√©rifier UE 5.6** : le `.uproject` utilise `"EngineAssociation": "5.6"`.
4. **Configurer** le serveur Python (voir `Python/README.md`) et lancer le serveur MCP.
5. Dans UE : **Project Settings ‚Üí Plugins ‚Üí Unreal MCP**  
   - `ServerHost=127.0.0.1`, `ServerPort=12029` (par d√©faut)  
   - (optionnel) activer `bAutoConnectOnEditorStartup`
6. **Diagnostics** : depuis la page de r√©glages, cliquez **Test Connection** puis **Send Ping**.

## ‚öôÔ∏è R√©glages plugin (r√©sum√©)
- **Network** : host/port, timeouts, heartbeats, auto-connect.
- **Security** : `AllowWrite`, `DryRun`, `RequireCheckout`, `AllowedContentRoots`, `AllowedTools/DeniedTools`.
- **Source Control** : `EnableSourceControl`, `AutoConnectSourceControl`, `PreferredProvider`.
- **Logging** : niveau verbose protocole, dossier de logs.
- **Diagnostics** : boutons `Test Connection`, `Send Ping`, `Open Logs Folder`.

> Par d√©faut, **AllowWrite=false** et **DryRun=true** ‚Üí aucune √©criture n‚Äôest effectu√©e tant que vous n‚Äôavez pas explicitement autoris√©.

## üîê Security & Hardening

La pile MCP impl√©mente d√©sormais une couche de d√©fense en profondeur inspir√©e du protocole v1.1¬†:

- **RBAC** : r√¥les `admin`, `dev`, `artist`, `read_only` r√©solus c√¥t√© plugin et serveur. Chaque r√¥le mappe sur des patterns allow/deny (`asset.*`, `sequence.*`, `!uat.*`‚Ä¶). Les denies (`!pattern`) sont prioritaires.
- **Allow/Deny patterns** : configuration unifi√©e (plugin + serveur YAML) pour les tools, avec support des glob `*`/`?`. Les racines de contenu autoris√©es/forbidden sont normalis√©es (`..`, symlinks, casse Windows) avant toute mutation.
- **Rate limiting** : fen√™tre glissante 60¬†s avec quota global & par tool (ex¬†: 120/min global, 30/min/tool). Les d√©passements retournent `RATE_LIMITED` + `retryAfterSec`.
- **Input limits** : taille JSON (KB), profondeur/listes (hard cap `array_items_max`) + validation `jsonschema` pour les outils critiques (`asset.batch_import`, `sequence.create`, `mi.set_params`, ‚Ä¶).
- **Audit sign√©** : chaque mutation renvoie un bloc `security` (`auditSig`, `serverTs`, `nonce`) sign√© HMAC-SHA256 (`MCP_AUDIT_SECRET`). Le client peut v√©rifier ou refuser (`RequireAuditSignature`).
- **Redaction** : les param√®tres/r√©sultats contenant `token`, `password`, `secret`, `key` sont remplac√©s par `[REDACTED]` dans les payloads de signature/logs.
- **Sandbox chemins** : toutes les entr√©es `path/dir/root` passent par une canonicalisation stricte. Les racines interdites l‚Äôemportent, sinon `PATH_NOT_ALLOWED` est renvoy√©.
- **Nouveaux codes d‚Äôerreur** : `TOOL_DENIED`, `PATH_NOT_ALLOWED`, `RATE_LIMITED`, `REQUEST_TOO_LARGE`, `ARRAY_TOO_LARGE`, `INVALID_PARAMS` (schema), `CONFIRMATION_REQUIRED` (SCM soft guard c√¥t√© UE).

### Configuration

**Plugin UE (`Project Settings ‚Üí Plugins ‚Üí Unreal MCP`)**

- `AllowedTools` accepte d√©sormais des patterns globs avec `!pattern` pour les denies prioritaires.
- `ForbiddenContentRoots` compl√®te `AllowedContentRoots` pour bloquer des sous-arbres (`/Game/Restricted`, `/Engine`, ‚Ä¶).
- `Role` (`admin|dev|artist|read_only`) s√©lectionne le profil RBAC appliqu√© lors des handshakes.
- Limites client (`MaxRequestSizeKB`, `MaxArrayItems`) prot√®gent la pipeline avant d‚Äôenvoyer le frame JSON.
- `RateLimitPerMin` (global + per-tool) √©vite de saturer le serveur avant transport.
- `RequireAuditSignature` force la v√©rification des r√©ponses mutantes (`UNVERIFIED_AUDIT` si la signature est manquante/incorrecte).

**Serveur Python (`Python/security/policy.yaml`)**

- Variable d‚Äôenvironnement `MCP_POLICY_PATH` ‚Üí YAML d√©crivant `roles`, `limits`, `paths`, `audit`.
- `audit.hmac_secret_env` indique la variable d‚Äôenvironnement contenant le secret (ex¬†: `MCP_AUDIT_SECRET`).
- Exemple¬†:

```yaml
roles:
  dev:
    allow: ["asset.*", "sequence.*", "level.*", "content.*"]
    deny: ["security.*"]
  read_only:
    allow: ["sequence.export", "content.scan", "mcp.health"]
    deny: ["*.**"]
limits:
  rate_per_minute_global: 120
  rate_per_minute_per_tool: 30
  request_size_kb: 512
  array_items_max: 10000
paths:
  allowed: ["/Game/Core", "/Game/Art"]
  forbidden: ["/Game/Restricted", "/Engine"]
audit:
  require_signature: true
  hmac_secret_env: MCP_AUDIT_SECRET
```

Placez le secret HMAC dans un fichier `.env` (permissions 600) ou dans l‚Äôenvironnement du service systemd (`Environment=MCP_AUDIT_SECRET=...`).

## üìà Observability & DX
- **Logs structur√©s JSONL** : c√¥t√© plugin `Saved/Logs/UnrealMCP_events.jsonl` & `UnrealMCP_metrics.jsonl`; c√¥t√© serveur Python `Python/logs/events.jsonl` & `metrics.jsonl` avec rotation.
- **Corr√©lation par `requestId`** : chaque tool embarque `meta.requestId`, timestamps (`ts`) et dur√©e (`durMs`) dans les r√©ponses et dans les logs.
- **M√©triques l√©g√®res** : incr√©ments `tool_calls_total` et dur√©es `tool_duration_ms` (par tool, succ√®s/erreur).
- **Outils de sant√©** : tool read-only `mcp.health` retourne versions, uptime, flags d‚Äôenforcement, RTT et infos plugin.
- **R√©glages** : nouveau `LogLevel`, `EnableJsonLogs` et boutons Diagnostics (ouvrir events/metrics log, tail live).

## üñ•Ô∏è CLI locale (`mcp`)
Un binaire `mcp` (Typer) est fourni pour piloter le serveur MCP sans passer par un agent externe.

```bash
# Lancer un tool directement
mcp run level.save_open --params-json '{"modifiedOnly": true}'

# Ex√©cuter une recette YAML (pipeline DAG)
mcp recipe run ./.mcp/pipelines/content_cleanup.yaml --vars GAME_ROOT=/Game/Core

# Valider / dry-run une recette
mcp recipe test ./.mcp/pipelines/content_cleanup.yaml --dry-run
```

| Commande          | Description                                      |
|-------------------|--------------------------------------------------|
| `mcp run`         | Ex√©cute un tool MCP unique avec param√®tres JSON  |
| `mcp recipe run`  | Ex√©cute un pipeline YAML (steps d√©pendants, DAG) |
| `mcp recipe test` | Valide la recette, affiche le plan, option dry-run |

Fonctionnalit√©s transverses : `--dry-run`, `--retry`, `--parallel`, `--vars`/`--vars-file`, `--select` (JMESPath), `--output json|yaml`, `--timeout`, `--log-level`, `--server`.

## üß∞ Outils expos√©s (MCP Tools)

### Lecture (toujours autoris√©es)
| Tool              | Description                                 | Params cl√©s                                      |
|-------------------|---------------------------------------------|--------------------------------------------------|
| `asset.find`      | Recherche d‚Äôassets via Asset Registry       | `paths[]`, `classNames[]`, `nameContains`, `limit/offset` |
| `asset.exists`    | Existence + classe d‚Äôun asset               | `objectPath`                                     |
| `asset.metadata`  | M√©tadonn√©es (class, tags, deps, size, ‚Ä¶)    | `objectPath`                                     |
| `sc.status`       | Statut SCM par fichier/asset                | `assets[]` ou `files[]`                          |

### Mutations (soumis aux gates & transactions)
| Tool          | Description                   | Remarques |
|---------------|-------------------------------|-----------|
| `sc.checkout` | Checkout d‚Äôun lot de fichiers | No-op possible selon provider (Git) |
| `sc.add`      | Marquer pour ajout            |           |
| `sc.revert`   | Revert local                  |           |
| `sc.submit`   | Submit/commit avec message    |           |

| Tool                    | Description                           | Notes                                                  |
|-------------------------|---------------------------------------|--------------------------------------------------------|
| `asset.create_folder`   | Cr√©er un dossier `/Game/...`          | Respecte `AllowedContentRoots`                         |
| `asset.rename`          | Renommer/d√©placer un asset (package)  | Cr√©e un redirector (corrigez via `asset.fix_redirectors`) |
| `asset.delete`          | Supprimer un ou plusieurs assets      | `force=false` bloque si r√©f√©renc√©                      |
| `asset.fix_redirectors` | Corriger les redirectors dans un path | Utilise `AssetTools`, compatible r√©cursif              |
| `asset.save_all`        | Sauvegarder assets modifi√©s           | Scope global ou par `paths[]`, `modifiedOnly` optionnel |
| `asset.batch_import`    | Importer un lot de fichiers           | Presets FBX/Textures/Audio, dry-run, SCM, conflits      |

#### Maps & Levels

| Tool                    | Description                                       | Notes                                |
|-------------------------|---------------------------------------------------|--------------------------------------|
| `level.save_open`       | Sauvegarde les maps ouvertes (persistante + sublevels charg√©s) | `modifiedOnly`, SCM/checkout respect√© |
| `level.load`            | Ouvre une map persistante dans l‚Äô√©diteur          | Option `loadSublevels` (`none/all/byNames`) |
| `level.unload`          | D√©charge des sous-niveaux/World Partition layers  | `allowMissing` pour ignorer les absents |
| `level.stream_sublevel` | Charge/D√©charge un streaming level ou DataLayer   | `blockUntilVisible`, support DataLayers |

```jsonc
// Exemple : level.load
{
  "mapPath": "/Game/Maps/Persistent.Persistent",
  "loadSublevels": "byNames",
  "sublevels": ["Gameplay", "Lighting"],
  "makeCurrent": true,
  "discardUnsaved": false
}
```

### Content Hygiene

| Tool                          | Type      | Description                                               |
|-------------------------------|-----------|-----------------------------------------------------------|
| `content.scan`                | read-only | Scan des refs cass√©es, assets manquants, redirectors, etc |
| `content.validate`            | read-only | V√©rifie naming, tailles textures, LODs, collisions, MI    |
| `content.fix_missing`         | mutant    | Fix redirectors + remap soft refs + purge redirectors     |
| `content.generate_thumbnails` | mutant    | R√©g√©n√®re les miniatures d‚Äôun lot d‚Äôassets                 |

```jsonc
// Exemple : content.scan
{
  "paths": ["/Game/Core", "/Game/Art"],
  "recursive": true,
  "includeUnusedTextures": true,
  "includeReferencers": true
}
```

```jsonc
// Exemple : content.fix_missing
{
  "paths": ["/Game/Core"],
  "recursive": true,
  "fix": {
    "redirectors": true,
    "remapReferences": true,
    "deleteStaleRedirectors": true
  },
  "save": true
}
```

#### Materials

| Tool                        | Description                                                   | Notes |
|-----------------------------|----------------------------------------------------------------|-------|
| `mi.create`                 | Cr√©e une Material Instance enfant d'un Material ou d'une MI    | Respecte `AllowedContentRoots`, overwrite option, SCM |
| `mi.set_params`             | Applique des overrides Scalar/Vector/Texture/StaticSwitch sur une MI existante | Support `clearUnset`, sauvegarde, audit d√©taill√© |
| `mi.batch_apply`            | Assigne des Material Instances √† des acteurs/composants par slot (index ou nom) | Sc√®ne uniquement (maps), Undo/Redo, pas de sauvegarde auto |
| `mesh.remap_material_slots` | Renomme/r√©ordonne les slots d'un StaticMesh (duplication optionnelle) | Option de rebind des acteurs, SCM + sauvegarde optionnelle |

```jsonc
// Exemple : mi.set_params
{
  "miObjectPath": "/Game/Materials/Instances/MI_Master_Red.MI_Master_Red",
  "scalars": { "Roughness": 0.35, "Metallic": 1.0 },
  "vectors": { "BaseColor": [1.0, 0.1, 0.1, 1.0] },
  "textures": { "Albedo": "/Game/Art/Textures/T_Orc_Diffuse.T_Orc_Diffuse" },
  "switches": { "UseDetail": true },
  "clearUnset": false,
  "save": true
}
```

```jsonc
// Exemple : mi.batch_apply (deux acteurs)
{
  "targets": [
    {
      "actorPath": "/Game/Maps/Demo.Demo:PersistentLevel.SM_Statue_1",
      "assign": [
        { "slot": 0, "mi": "/Game/Materials/Instances/MI_Stone.MI_Stone" },
        { "slot": "Eyes", "mi": "/Game/Materials/Instances/MI_Gold.MI_Gold" }
      ]
    },
    {
      "actorPath": "/Game/Maps/Demo.Demo:PersistentLevel.SK_Orc_1",
      "component": "Mesh",
      "assign": [
        { "slot": "Body", "mi": "/Game/Characters/Materials/MI_OrcSkin.MI_OrcSkin" }
      ]
    }
  ]
}
```

#### Niagara (Editor)

| Tool                      | Description                                                       | Notes                                                          |
|---------------------------|-------------------------------------------------------------------|----------------------------------------------------------------|
| `niagara.spawn_component` | Instancie un `UNiagaraComponent` √† partir d‚Äôun `UNiagaraSystem`   | Attach √† un acteur existant ou spawn libre, `autoActivate`, s√©lection optionnelle |
| `niagara.set_user_params` | D√©finit des User Parameters typ√©s (float, bool, int, vector, color, texture/mesh‚Ä¶) | Mutant : transaction + audit, support `saveActor`              |
| `niagara.activate`        | Active un composant Niagara (option `reset`)                      | Respecte Undo/Redo, audit                                      |
| `niagara.deactivate`      | D√©sactive un composant Niagara (option `immediate`)               | `DeactivateImmediate` si demand√©, audit                        |

```jsonc
// Exemple : niagara.spawn_component
{
  "systemPath": "/Game/VFX/Systems/NS_Fire.NS_Fire",
  "attach": {
    "actorPath": "/Game/Maps/UEDPIE_0_Map.Map:PersistentLevel.SM_Statue_1",
    "socketName": "FX_Socket",
    "keepWorldTransform": true
  },
  "autoActivate": true,
  "initialUserParams": {
    "Float:Intensity": 2.5,
    "Vector:Tint": [1.0, 0.5, 0.2, 1.0],
    "Bool:Loop": true
  },
  "select": true
}
```

#### Actors

| Tool             | Description                          | Notes                                                   |
|------------------|--------------------------------------|---------------------------------------------------------|
| `actor.spawn`    | Instancier un acteur (classe ou BP)  | Transform + tags optionnels, s√©lection possible         |
| `actor.destroy`  | D√©truire un ou plusieurs acteurs     | `allowMissing=true` ignore les r√©f√©rences absentes      |
| `actor.attach`   | Attacher un acteur √† un parent       | Supporte `keepWorldTransform`, `socketName`, weld       |
| `actor.transform`| Appliquer set/add sur location/rot/scale | `set` absolu puis `add` (delta)                        |
| `actor.tag`      | Ajouter/retirer/remplacer des tags   | `replace` (array ou `null`), `add`, `remove`            |

#### Sequencer

| Tool                     | Description                                      | Notes                                                  |
|--------------------------|--------------------------------------------------|--------------------------------------------------------|
| `sequence.create`        | Cr√©e un Level Sequence (fps, dur√©e, eval)        | Cam√©ra Cine + CameraCut optionnels ; bind d'acteurs existants |
| `sequence.bind_actors`   | Lier un ou plusieurs acteurs √† un Sequence       | Options `skipIfAlreadyBound`, `overwriteIfExists`, `labelPrefix`, `save` |
| `sequence.unbind`        | Retirer des bindings par GUID ou acteur          | Mutant ; support `save`, audit d√©taill√©                |
| `sequence.list_bindings` | Lister les bindings existants d'un Sequence      | Read-only ; renvoie GUID, label, acteur courant        |
| `sequence.add_tracks`    | Ajouter des pistes (Transform/Visibility/Property) + cuts cam√©ra | Mutant ; overwrite/dryRun/save, SCM + audit |
| `sequence.export`        | Exporter un Sequence en JSON/CSV (bindings, pistes, cl√©s)        | Read-only ; filtres `include.*`, `frameRange`, CSV aplati |

```jsonc
// Exemple : sequence.create minimal
{
  "sequencePath": "/Game/Cinematics/Seq/SEQ_Intro",
  "displayRate": [24, 1],
  "durationFrames": 240,
  "evaluationType": "WithSubFrames"
}
```

```jsonc
// Exemple : sequence.bind_actors
{
  "sequencePath": "/Game/Cinematics/Seq/SEQ_Intro.SEQ_Intro",
  "actorPaths": [
    "/Game/Maps/UEDPIE_0_Map.Map:PersistentLevel.BP_TrainingDummy_C_2",
    "/Game/Maps/UEDPIE_0_Map.Map:PersistentLevel.CineCam_Intro"
  ],
  "skipIfAlreadyBound": true,
  "labelPrefix": "Dummy_",
  "overwriteIfExists": false,
  "save": true
}
```

```jsonc
// Exemple : sequence.add_tracks (transform + cuts)
{
  "sequencePath": "/Game/Cinematics/Seq/SEQ_Intro.SEQ_Intro",
  "bindings": [
    {
      "actorPath": "/Game/Maps/Map:PersistentLevel.BP_TrainingDummy_C_2",
      "tracks": [
        {
          "type": "Transform",
          "keys": [
            { "frame": 0, "location": [0, 0, 0] },
            { "frame": 120, "location": [0, 300, 0], "rotation": [0, 90, 0] }
          ]
        }
      ]
    }
  ],
  "cameraCuts": [
    { "frameStart": 0, "frameEnd": 60, "cameraBindingId": "3C7C8B2E-1234-5678-ABCD-000000000001" }
  ],
  "overwrite": false,
  "save": true
}
```

```jsonc
// Exemple : sequence.export (JSON)
{
  "sequencePath": "/Game/Cinematics/Seq/SEQ_Intro.SEQ_Intro",
  "format": "json",
  "include": {
    "tracks": ["Transform", "Visibility"],
    "keys": true
  },
  "frameRange": { "start": 0, "end": 120 },
  "worldActorPaths": true
}
```

```jsonc
// Exemple : sequence.export (CSV)
{
  "sequencePath": "/Game/Cinematics/Seq/SEQ_Intro.SEQ_Intro",
  "format": "csv",
  "include": {
    "tracks": ["Transform", "CameraCut"],
    "bindings": true
  },
  "flattenProperties": true
}
```

#### √âditeur

| Tool              | Type      | Description                               | Notes                                                |
|-------------------|-----------|-------------------------------------------|------------------------------------------------------|
| `level.select`    | read-only | S√©lectionner des acteurs par filtres      | `mode=replace|add|remove`, support tags/classes        |
| `viewport.focus`  | read-only | Recentrer la cam√©ra √©diteur               | Acteurs, box ou location; `orbit` = cadrage orbital  |
| `camera.bookmark` | mixte     | `set/jump/list` de bookmarks cam√©ra       | `persist=true` √©crit dans le niveau (mutant + gate)  |

```jsonc
// Exemple : actor.spawn
{
  "classPath": "/Script/Engine.StaticMeshActor",
  "location": [0.0, 0.0, 150.0],
  "rotation": [0.0, 90.0, 0.0],
  "tags": ["SpawnedByMCP"],
  "select": true
}
```

```jsonc
// Exemple : level.select
{
  "filters": {
    "nameContains": "Dummy",
    "classNames": ["BP_TrainingDummy_C"],
    "tags": ["Training"]
  },
  "mode": "replace",
  "selectChildren": false
}
```

```jsonc
// Exemple : viewport.focus
{
  "actors": [
    "/Game/Maps/UEDPIE_0_Untitled.Untitled:PersistentLevel.BP_TrainingDummy_C_2",
    "/Game/Maps/UEDPIE_0_Untitled.Untitled:PersistentLevel.StaticMeshActor_15"
  ],
  "orbit": true,
  "transitionSec": 0.0
}
```

```jsonc
// Exemple : asset.rename
{
  "fromObjectPath": "/Game/Core/Old/BP_SpellProjectile.BP_SpellProjectile",
  "toPackagePath": "/Game/Core/Spells/BP_SpellProjectile"
}

// Exemple : asset.fix_redirectors
{
  "paths": ["/Game/Core", "/Game/Art"],
  "recursive": true
}

// Exemple : asset.batch_import
{
  "destPath": "/Game/Art/Characters/Orc",
  "files": ["D:/Imports/Orc/mesh/Orc.fbx", "D:/Imports/Orc/textures/Orc_Diffuse.png"],
  "preset": "fbx_character"
}
```

### Build & Test

| Tool               | Type     | Description                                     | Notes                                |
| ------------------ | -------- | ----------------------------------------------- | ------------------------------------ |
| `uat.buildcookrun` | external | Lance RunUAT BuildCookRun (cook/stage/package‚Ä¶) | Logs persistants, artefacts, dry-run |
| `automation.run_specs` | external | Lance Automation Tests via UnrealEditor-Cmd | Export log/XML, parsing basique |
| `gauntlet.run` | external | Lance Gauntlet sur build packag√© | Logs UAT + Gauntlet, artifacts |

```json
{
  "tool": "uat.buildcookrun",
  "params": {
    "engineRoot": "D:/UE_5.6",
    "uproject": "D:/Proj/MyGame/MyGame.uproject",
    "platforms": ["Win64"],
    "cook": true,
    "stage": true,
    "package": true,
    "archive": true
  }
}
```

```json
{"tool":"automation.run_specs","params":{"engineRoot":"D:/UE_5.6","uproject":"D:/Proj/MyGame/MyGame.uproject","tests":["Project.Functional"],"timeoutMinutes":30}}
```

```json
{"tool":"gauntlet.run","params":{"engineRoot":"D:/UE_5.6","uproject":"D:/Proj/MyGame/MyGame.uproject","test":"MyGauntletSuite","platform":"Win64","build":{"path":"D:/Builds/MyGame/WindowsNoEditor"}}}
```

  > **Transactions & Undo** : chaque mutation est faite dans une transaction √©diteur (Ctrl+Z possible).
  > **SCM** : si `RequireCheckout=true`, √©chec si l‚Äôasset n‚Äôest pas checkout.

## üîê Mod√®le de s√©curit√©
- **Read-only par d√©faut** : `AllowWrite=false`.  
- **Dry-run** : si activ√©, les mutations renvoient un **plan** (`audit.actions[]`) sans rien changer.  
- **AllowedContentRoots** : seules les √©critures dans ces chemins `/Game/...` sont permises.  
- **Allow/Deny-list** de tools : bloque/autorise par nom de tool, ex. `sc.submit`.

## üß™ Tests & CI (aper√ßu)
- Protocol v1 test√© (framing, ping/pong, timeouts).  
- Tools lecture test√©s avec l‚ÄôAsset Registry.  
- Mutations envelopp√©es de transactions + SCM optionnel.  
- (Conseill√©) Nightly Automation/Gauntlet pour projets complexes.

## üõ† D√©veloppement local
- C√¥t√© UE : modules `Json`, `JsonUtilities`, `Sockets`, `Networking`, `DeveloperSettings`, `SourceControl`.
- C√¥t√© Python : lib standard (`socket`, `struct`, `json`, `argparse`, `selectors`).

## üßØ Troubleshooting
- **Connection refused (127.0.0.1:12029)** : serveur Python non lanc√© / port erron√© (voir Settings).  
- **WRITE_NOT_ALLOWED** : activer `AllowWrite` **et** v√©rifier `AllowedContentRoots`.  
- **SOURCE_CONTROL_REQUIRED** : activer/brancher le provider SCM ou d√©sactiver `RequireCheckout`.  
- **Ping timeouts** : v√©rifier firewall/antivirus, `ReadTimeoutSec` et `HeartbeatIntervalSec`.

## üìú Licence & Contribuer
- PRs bienvenues (features packs : Assets/Actors, Sequencer, Materials/MI, Niagara, Build/Test).  
- Merci d‚Äôouvrir une issue avec un **use case** clair et crit√®res d‚Äôacceptation.

